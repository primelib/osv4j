package io.github.primelib.osv4j.model;

import java.util.function.Consumer;
import org.jetbrains.annotations.ApiStatus;
import javax.annotation.processing.Generated;
import lombok.AccessLevel;
import lombok.Builder;
import lombok.Getter;
import lombok.Setter;
import lombok.EqualsAndHashCode;
import lombok.ToString;
import lombok.NoArgsConstructor;
import lombok.experimental.Accessors;

import java.time.OffsetDateTime;
import java.util.List;
import com.fasterxml.jackson.annotation.JsonPropertyOrder;
import com.fasterxml.jackson.annotation.JsonTypeName;
import com.fasterxml.jackson.annotation.JsonProperty;

/**
 * OsvVulnerability
 *
 */
@Getter
@Setter
@EqualsAndHashCode
@ToString
@Accessors(fluent = true, chain = true)
@NoArgsConstructor(access = AccessLevel.PROTECTED, force = true)
@Builder
@JsonPropertyOrder({
    "schemaVersion",
    "id",
    "published",
    "modified",
    "withdrawn",
    "aliases",
    "related",
    "summary",
    "details",
    "affected",
    "references",
    "databaseSpecific",
    "severity",
    "credits"
})
@JsonTypeName("osvVulnerability")
@Generated(value = "io.github.primelib.primecodegen.javafeign.JavaFeignGenerator")
public class OsvVulnerability {

    /**
     * The OSV schema version.
     */
    @JsonProperty("schemaVersion")
    protected String schemaVersion;

    /**
     * The {@code id} field is a unique identifier for the vulnerability entry. It is a string of the format {@code &amp;lt;DB&amp;gt;-&amp;lt;ENTRYID&amp;gt;}, where {@code DB} names the database and {@code ENTRYID} is in the format used by the database. For example: “OSV-2020-111”, “CVE-2021-3114”, or “GHSA-vp9c-fpxx-744v”.
     */
    @JsonProperty("id")
    protected String id;

    /**
     * The RFC3339 timestamp indicating when this entry was published.
     */
    @JsonProperty("published")
    protected OffsetDateTime published;

    /**
     * The RFC3339 timestamp indicating when this entry was last modified.
     */
    @JsonProperty("modified")
    protected OffsetDateTime modified;

    /**
     * Optional. The RFC3339 timestamp indicating when this entry is considered to be withdrawn.
     */
    @JsonProperty("withdrawn")
    protected OffsetDateTime withdrawn;

    /**
     * Optional. IDs for the same vulnerability in other databases.
     */
    @JsonProperty("aliases")
    protected List<String> aliases;

    /**
     * Optional. List of IDs of closely related vulnerabilities, such as the same problem in alternate ecosystems.
     */
    @JsonProperty("related")
    protected List<String> related;

    /**
     * Required. One line human readable summary for the vulnerability. It is recommended to keep this under 120 characters.
     */
    @JsonProperty("summary")
    protected String summary;

    /**
     * Required. Any additional human readable details for the vulnerability.
     */
    @JsonProperty("details")
    protected String details;

    /**
     * Required. Affected commit ranges and versions.
     */
    @JsonProperty("affected")
    protected List<OsvAffected> affected;

    /**
     * Optional. URLs to more information/advisories (including the scheme e.g "https://").
     */
    @JsonProperty("references")
    protected List<OsvReference> references;

    /**
     * Optional. JSON object holding additional information about the vulnerability as defined by the database for which the record applies.
     */
    @JsonProperty("databaseSpecific")
    protected Object databaseSpecific;

    /**
     * Optional. Severity of the vulnerability.
     */
    @JsonProperty("severity")
    protected List<OsvSeverity> severity;

    /**
     * Optional. Credits for the vulnerability.
     */
    @JsonProperty("credits")
    protected List<OsvCredit> credits;

    /**
     * Constructs a validated instance of {@link OsvVulnerability}.
     *
     * @param spec the specification to process
     */
    public OsvVulnerability(Consumer<OsvVulnerability> spec) {
        spec.accept(this);
    }

    /**
     * Constructs a validated instance of {@link OsvVulnerability}.
     * <p>
     * NOTE: This constructor is not considered stable and may change if the model is updated. Consider using {@link #OsvVulnerability(Consumer)} instead.
     * @param schemaVersion The OSV schema version.
     * @param id The {@code id} field is a unique identifier for the vulnerability entry. It is a string of the format {@code &amp;lt;DB&amp;gt;-&amp;lt;ENTRYID&amp;gt;}, where {@code DB} names the database and {@code ENTRYID} is in the format used by the database. For example: “OSV-2020-111”, “CVE-2021-3114”, or “GHSA-vp9c-fpxx-744v”.
     * @param published The RFC3339 timestamp indicating when this entry was published.
     * @param modified The RFC3339 timestamp indicating when this entry was last modified.
     * @param withdrawn Optional. The RFC3339 timestamp indicating when this entry is considered to be withdrawn.
     * @param aliases Optional. IDs for the same vulnerability in other databases.
     * @param related Optional. List of IDs of closely related vulnerabilities, such as the same problem in alternate ecosystems.
     * @param summary Required. One line human readable summary for the vulnerability. It is recommended to keep this under 120 characters.
     * @param details Required. Any additional human readable details for the vulnerability.
     * @param affected Required. Affected commit ranges and versions.
     * @param references Optional. URLs to more information/advisories (including the scheme e.g "https://").
     * @param databaseSpecific Optional. JSON object holding additional information about the vulnerability as defined by the database for which the record applies.
     * @param severity Optional. Severity of the vulnerability.
     * @param credits Optional. Credits for the vulnerability.
     */
    @ApiStatus.Internal
    public OsvVulnerability(String schemaVersion, String id, OffsetDateTime published, OffsetDateTime modified, OffsetDateTime withdrawn, List<String> aliases, List<String> related, String summary, String details, List<OsvAffected> affected, List<OsvReference> references, Object databaseSpecific, List<OsvSeverity> severity, List<OsvCredit> credits) {
        this.schemaVersion = schemaVersion;
        this.id = id;
        this.published = published;
        this.modified = modified;
        this.withdrawn = withdrawn;
        this.aliases = aliases;
        this.related = related;
        this.summary = summary;
        this.details = details;
        this.affected = affected;
        this.references = references;
        this.databaseSpecific = databaseSpecific;
        this.severity = severity;
        this.credits = credits;
    }

}
